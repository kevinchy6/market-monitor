/* style.css — Market Monitor Dark Bloomberg Theme */

/* ========================================
   FONTS
   ======================================== */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap');

/* ========================================
   DESIGN TOKENS
   ======================================== */
:root {
  /* Type Scale */
  --text-xs:   clamp(0.625rem, 0.6rem + 0.15vw, 0.75rem);
  --text-sm:   clamp(0.75rem, 0.7rem + 0.2vw, 0.8125rem);
  --text-base: clamp(0.8125rem, 0.75rem + 0.3vw, 0.875rem);
  --text-lg:   clamp(0.875rem, 0.8rem + 0.4vw, 1rem);
  --text-xl:   clamp(1rem, 0.9rem + 0.5vw, 1.25rem);
  --text-2xl:  clamp(1.25rem, 1rem + 0.8vw, 1.75rem);

  /* Spacing (4px grid) */
  --space-1:  0.25rem;
  --space-2:  0.5rem;
  --space-3:  0.75rem;
  --space-4:  1rem;
  --space-5:  1.25rem;
  --space-6:  1.5rem;
  --space-8:  2rem;
  --space-10: 2.5rem;
  --space-12: 3rem;

  /* Font families */
  --font-body: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', 'SF Mono', monospace;

  /* ============================================
     DARK THEME — Bloomberg Terminal Style
     ============================================ */
  --color-bg:           #0d1117;
  --color-surface:      #161b22;
  --color-surface-2:    #1c2333;
  --color-border:       #30363d;
  --color-border-muted: #21262d;

  /* Text */
  --color-text:         #e6edf3;
  --color-text-muted:   #8b949e;
  --color-text-faint:   #484f58;

  /* Semantic */
  --color-green:        #3fb950;
  --color-green-dim:    #238636;
  --color-red:          #f85149;
  --color-red-dim:      #da3633;
  --color-yellow:       #d29922;
  --color-blue:         #58a6ff;
  --color-orange:       #e3b341;
  --color-cyan:         #56d4dd;

  /* Heatmap cell backgrounds */
  --hm-deep-green:   rgba(63, 185, 80, 0.25);
  --hm-light-green:  rgba(63, 185, 80, 0.12);
  --hm-neutral:      transparent;
  --hm-light-red:    rgba(248, 81, 73, 0.12);
  --hm-deep-red:     rgba(248, 81, 73, 0.25);
  --hm-yellow:       rgba(210, 153, 34, 0.2);

  /* Table */
  --table-header-bg:    #1c2333;
  --table-row-hover:    #1c2333;
  --table-row-alt:      #111820;
  --table-row-default:  #0d1117;

  /* Radius */
  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;

  /* Transition */
  --transition-fast: 120ms cubic-bezier(0.16, 1, 0.3, 1);
  --transition-normal: 180ms cubic-bezier(0.16, 1, 0.3, 1);
}

/* ========================================
   LAYOUT — Dashboard Shell
   ======================================== */
html, body {
  height: 100%;
  overflow: hidden;
  margin: 0;
}

.dashboard {
  display: flex;
  flex-direction: column;
  height: 100dvh;
  background: var(--color-bg);
}

/* ---- TOP BAR ---- */
.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-2) var(--space-4);
  background: var(--color-surface);
  border-bottom: 1px solid var(--color-border);
  flex-shrink: 0;
  min-height: 44px;
  z-index: 20;
}

.topbar-left {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.topbar-logo {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.topbar-logo svg {
  width: 24px;
  height: 24px;
  flex-shrink: 0;
}

.topbar-title {
  font-family: var(--font-body);
  font-size: var(--text-lg);
  font-weight: 700;
  color: var(--color-text);
  letter-spacing: -0.01em;
}

.topbar-right {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.last-updated {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: var(--color-text-faint);
  font-variant-numeric: tabular-nums lining-nums;
}

.btn-refresh {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1) var(--space-2);
  background: var(--color-surface-2);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  color: var(--color-text-muted);
  font-family: var(--font-body);
  font-size: var(--text-xs);
  font-weight: 500;
  transition: all var(--transition-normal);
  cursor: pointer;
  min-height: 32px;
}

.btn-refresh:hover {
  color: var(--color-text);
  background: var(--color-border);
}

.btn-refresh.loading svg {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ---- MAIN CONTENT ---- */
.main-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  overscroll-behavior: contain;
  padding: var(--space-3);
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

/* ---- BREADTH CARD ---- */
.breadth-section {
  flex-shrink: 0;
}

.breadth-card {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--space-3) var(--space-4);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-8);
  flex-wrap: wrap;
}

.breadth-metric {
  text-align: center;
}

.breadth-metric-label {
  font-family: var(--font-body);
  font-size: var(--text-xs);
  color: var(--color-text-faint);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: var(--space-1);
}

.breadth-metric-value {
  font-family: var(--font-mono);
  font-size: var(--text-xl);
  font-weight: 700;
  color: var(--color-text);
  font-variant-numeric: tabular-nums lining-nums;
  line-height: 1.2;
}

.breadth-label {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-1) var(--space-3);
  border-radius: var(--radius-sm);
  font-family: var(--font-body);
  font-size: var(--text-sm);
  font-weight: 600;
  letter-spacing: 0.04em;
  text-transform: uppercase;
}

.breadth-label.strong {
  background: var(--hm-deep-green);
  color: var(--color-green);
}

.breadth-label.weak {
  background: var(--hm-deep-red);
  color: var(--color-red);
}

.breadth-label.neutral {
  background: var(--hm-yellow);
  color: var(--color-yellow);
}

.breadth-updated {
  font-family: var(--font-mono);
  font-size: calc(var(--text-xs) - 1px);
  color: var(--color-text-faint);
  align-self: center;
}

.breadth-bar-container {
  width: 120px;
  height: 6px;
  background: var(--color-border);
  border-radius: 3px;
  overflow: hidden;
  margin: var(--space-1) auto 0;
}

.breadth-bar {
  height: 100%;
  border-radius: 3px;
  transition: width 0.5s cubic-bezier(0.16, 1, 0.3, 1);
}

/* ---- TWO-COLUMN TABLES LAYOUT ---- */
.tables-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-3);
  align-items: start;
}

@media (max-width: 1100px) {
  .tables-grid {
    grid-template-columns: 1fr;
  }
}

.left-column {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.right-column {
  display: flex;
  flex-direction: column;
}

/* ---- TABLE SECTION ---- */
.table-section {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.table-section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-2) var(--space-3);
  background: var(--color-surface-2);
  border-bottom: 1px solid var(--color-border);
  flex-shrink: 0;
}

.table-section-title {
  font-family: var(--font-body);
  font-size: var(--text-sm);
  font-weight: 600;
  color: var(--color-text);
  letter-spacing: 0.01em;
}

.table-section-count {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: var(--color-text-faint);
}

.table-wrapper {
  overflow-x: auto;
  overscroll-behavior: contain;
  flex: 1;
  -webkit-overflow-scrolling: touch;
}

/* ---- DATA TABLE ---- */
.data-table {
  width: 100%;
  border-collapse: collapse;
  font-variant-numeric: tabular-nums lining-nums;
}

.data-table thead {
  position: sticky;
  top: 0;
  z-index: 2;
}

.data-table th {
  background: var(--table-header-bg);
  padding: var(--space-1) var(--space-2);
  text-align: right;
  font-family: var(--font-body);
  font-size: var(--text-xs);
  font-weight: 600;
  color: var(--color-text-faint);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  white-space: nowrap;
  border-bottom: 1px solid var(--color-border);
  user-select: none;
}

.data-table th:first-child,
.data-table th:nth-child(2) {
  text-align: left;
}

.data-table th.col-market {
  text-align: left;
  min-width: 100px;
}

.data-table th.col-symbol {
  text-align: left;
  min-width: 60px;
}

/* Ensure first two columns left-align even when sortable */
.data-table th[data-sort-key="name"],
.data-table th[data-sort-key="symbol"] {
  text-align: left;
}

.data-table td {
  padding: var(--space-1) var(--space-2);
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  font-weight: 400;
  color: var(--color-text);
  text-align: right;
  white-space: nowrap;
  border-bottom: 1px solid var(--color-border-muted);
  transition: background var(--transition-fast);
}

.data-table td:first-child {
  font-family: var(--font-body);
  font-weight: 500;
  text-align: left;
  color: var(--color-text);
  max-width: 160px;
  overflow: hidden;
  text-overflow: ellipsis;
  position: sticky;
  left: 0;
  z-index: 1;
  background: inherit;
}

.data-table th:first-child {
  position: sticky;
  left: 0;
  z-index: 3;
  background: var(--table-header-bg);
}

.data-table td:nth-child(2) {
  text-align: left;
  color: var(--color-text-muted);
  font-size: calc(var(--text-xs) - 1px);
}

.data-table tbody tr {
  transition: background var(--transition-fast);
}

.data-table tbody tr:nth-child(even) {
  background: var(--table-row-alt);
}

.data-table tbody tr:nth-child(odd) {
  background: var(--table-row-default);
}

.data-table tbody tr:nth-child(even) td:first-child {
  background: var(--table-row-alt);
}

.data-table tbody tr:nth-child(odd) td:first-child {
  background: var(--table-row-default);
}

.data-table tbody tr:hover {
  background: var(--table-row-hover) !important;
}

.data-table tbody tr:hover td:first-child {
  background: var(--table-row-hover) !important;
}

/* ---- HEATMAP CELLS ---- */
.cell-positive-strong {
  background: var(--hm-deep-green) !important;
  color: var(--color-green) !important;
}

.cell-positive {
  background: var(--hm-light-green) !important;
  color: var(--color-green) !important;
}

.cell-negative {
  background: var(--hm-light-red) !important;
  color: var(--color-red) !important;
}

.cell-negative-strong {
  background: var(--hm-deep-red) !important;
  color: var(--color-red) !important;
}

.cell-neutral {
  color: var(--color-text-muted);
}

/* ---- FLOW BADGES ---- */
.flow-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 1px 6px;
  border-radius: 3px;
  font-family: var(--font-mono);
  font-size: calc(var(--text-xs) - 1px);
  font-weight: 600;
  letter-spacing: 0.02em;
  white-space: nowrap;
  min-width: 28px;
}

.flow-badge.green {
  background: rgba(63, 185, 80, 0.2);
  color: #3fb950;
}

.flow-badge.bright-green {
  background: rgba(63, 185, 80, 0.3);
  color: #56d364;
}

.flow-badge.light-green {
  background: rgba(63, 185, 80, 0.12);
  color: #7ee787;
}

.flow-badge.yellow {
  background: rgba(210, 153, 34, 0.2);
  color: #d29922;
}

.flow-badge.orange {
  background: rgba(227, 130, 40, 0.2);
  color: #e38228;
}

.flow-badge.red {
  background: rgba(248, 81, 73, 0.2);
  color: #f85149;
}

.flow-badge.deep-red {
  background: rgba(248, 81, 73, 0.3);
  color: #ff7b72;
}

.flow-badge.gray {
  background: rgba(139, 148, 158, 0.15);
  color: #8b949e;
}

/* ---- SKELETON LOADING ---- */
.skeleton-row td {
  position: relative;
  overflow: hidden;
}

.skeleton-cell {
  display: inline-block;
  height: 14px;
  width: 48px;
  background: var(--color-border-muted);
  border-radius: 3px;
  animation: shimmer 1.5s infinite;
}

.skeleton-cell.wide { width: 80px; }
.skeleton-cell.narrow { width: 32px; }

@keyframes shimmer {
  0% { opacity: 0.4; }
  50% { opacity: 0.7; }
  100% { opacity: 0.4; }
}

/* ---- ERROR CELL ---- */
.cell-error {
  color: var(--color-text-faint) !important;
}

/* ---- STATUS DOT ---- */
.status-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  margin-right: var(--space-1);
}

.status-dot.live {
  background: var(--color-green);
  box-shadow: 0 0 4px var(--color-green);
  animation: pulse-dot 2s ease-in-out infinite;
}

.status-dot.stale {
  background: var(--color-yellow);
}

.status-dot.error {
  background: var(--color-red);
}

@keyframes pulse-dot {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}

/* ---- SORT INDICATOR ---- */
.sortable-th {
  cursor: pointer;
  user-select: none;
  transition: color var(--transition-fast), background var(--transition-fast);
}

.sortable-th:hover {
  color: var(--color-text-muted);
  background: rgba(255, 255, 255, 0.03);
}

.sortable-th.sorted {
  color: var(--color-blue);
  background: rgba(88, 166, 255, 0.06);
}

.th-content {
  display: inline-flex;
  align-items: center;
  gap: 3px;
}

.sort-arrow {
  font-size: 8px;
  opacity: 0.25;
  transition: opacity var(--transition-fast);
  line-height: 1;
}

.sortable-th:hover .sort-arrow {
  opacity: 0.6;
}

.sortable-th.sorted .sort-arrow {
  opacity: 1;
  color: var(--color-blue);
}

/* ---- PERIOD RETURN COLUMNS (WTD/MTD/YTD) ---- */
.data-table th:nth-child(n+4),
.data-table td:nth-child(n+4) {
  border-left: 1px solid var(--color-border-muted);
}

/* ---- RESPONSIVE ---- */
@media (max-width: 1200px) {
  .breadth-card {
    gap: var(--space-4);
  }
}

@media (max-width: 768px) {
  .main-content {
    padding: var(--space-2);
    gap: var(--space-2);
  }
  .topbar {
    padding: var(--space-2);
    flex-wrap: wrap;
    gap: var(--space-2);
  }
  .breadth-card {
    flex-direction: column;
    gap: var(--space-3);
    padding: var(--space-3);
  }
  .data-table td,
  .data-table th {
    padding: var(--space-1);
  }
}

/* ---- SCROLLBAR STYLING ---- */
.main-content::-webkit-scrollbar,
.table-wrapper::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.main-content::-webkit-scrollbar-track,
.table-wrapper::-webkit-scrollbar-track {
  background: transparent;
}

.main-content::-webkit-scrollbar-thumb,
.table-wrapper::-webkit-scrollbar-thumb {
  background: var(--color-border);
  border-radius: 3px;
}

.main-content::-webkit-scrollbar-thumb:hover,
.table-wrapper::-webkit-scrollbar-thumb:hover {
  background: var(--color-text-faint);
}

/* Firefox scrollbar */
.main-content,
.table-wrapper {
  scrollbar-width: thin;
  scrollbar-color: var(--color-border) transparent;
}
